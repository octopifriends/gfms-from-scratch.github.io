<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 0: Getting Started</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">GEOG 288KC</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">üè† home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">üìã syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-weekly-sessions" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">üíª weekly sessions</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-weekly-sessions">    
        <li>
    <a class="dropdown-item" href="../chapters/c00a-foundation_model_architectures.html">
 <span class="dropdown-text">Session 0a - ü™ú Foundation Model Architectures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c01-geospatial-data-foundations.html">
 <span class="dropdown-text">Session 1 - üìä Geospatial Data Foundations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c02-spatial-temporal-attention-mechanisms.html">
 <span class="dropdown-text">Session 2 - üß† Spatial-Temporal Attention Mechanisms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c03-complete-gfm-architecture.html">
 <span class="dropdown-text">Session 3 - üèóÔ∏è Complete GFM Architecture</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c04-pretraining-implementation.html">
 <span class="dropdown-text">Session 4 - üî• Pretraining Implementation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c05-training-loop-optimization.html">
 <span class="dropdown-text">Session 5 - ‚öôÔ∏è Training Loop Optimization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c06-model-evaluation-analysis.html">
 <span class="dropdown-text">Session 6 - üìà Model Evaluation &amp; Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c07-integration-with-existing-models.html">
 <span class="dropdown-text">Session 7 - ü§ù Integration with Existing Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c08-task-specific-finetuning.html">
 <span class="dropdown-text">Session 8 - üîß Task-Specific Fine-tuning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c09-model-implementation-deployment.html">
 <span class="dropdown-text">Session 9 - ‚òÅÔ∏è Model Implementation &amp; Deployment</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../chapters/c10-project-presentations-synthesis.html">
 <span class="dropdown-text">Session 10 - üéØ Project Presentations &amp; Synthesis</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cheatsheets" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">üëÄ Cheatsheets</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-cheatsheets">    
        <li class="dropdown-header">üèóÔ∏è Foundation Models &amp; AI</li>
        <li>
    <a class="dropdown-item" href="../chapters/c00a-foundation_model_architectures.html">
 <span class="dropdown-text">Foundation Model Architectures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/gfm_architecture.html">
 <span class="dropdown-text">GFM Architecture Cheatsheet</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/finetuning_basics.html">
 <span class="dropdown-text">Fine-tuning Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/multimodal_learning.html">
 <span class="dropdown-text">Multi-modal Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/model_evaluation_validation.html">
 <span class="dropdown-text">Model Evaluation &amp; Validation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/loading_models.html">
 <span class="dropdown-text">Loading Pre-trained Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/model_inference.html">
 <span class="dropdown-text">Model Inference &amp; Feature Extraction</span></a>
  </li>  
        <li class="dropdown-header">üó∫Ô∏è Geospatial Data &amp; Remote Sensing</li>
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/geospatial_data_remote_sensing.html">
 <span class="dropdown-text">Geospatial Data &amp; Remote Sensing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/stac_apis.html">
 <span class="dropdown-text">STAC APIs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/rasterio_basics.html">
 <span class="dropdown-text">Rasterio Basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/xarray_basics.html">
 <span class="dropdown-text">Xarray for Multi-dimensional Data</span></a>
  </li>  
        <li class="dropdown-header">üî• PyTorch &amp; Deep Learning</li>
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/pytorch_tensors.html">
 <span class="dropdown-text">PyTorch Tensors</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/torchgeo_basics.html">
 <span class="dropdown-text">TorchGeo Datasets &amp; Transforms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/dataloader_satellite.html">
 <span class="dropdown-text">Data Loading for Satellite Imagery</span></a>
  </li>  
        <li class="dropdown-header">üìä Visualization &amp; Analysis</li>
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/plotting_satellite.html">
 <span class="dropdown-text">Plotting Satellite Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/folium_basics.html">
 <span class="dropdown-text">Interactive Maps with Folium</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/matplotlib_geospatial.html">
 <span class="dropdown-text">Geospatial Plotting with Matplotlib</span></a>
  </li>  
        <li class="dropdown-header">‚òÅÔ∏è Deployment &amp; Scaling</li>
        <li>
    <a class="dropdown-item" href="../extras/cheatsheets/cloud_scalable_computing.html">
 <span class="dropdown-text">Cloud &amp; Scalable Computing</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extras" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">üìñ extras</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-extras">    
        <li>
    <a class="dropdown-item" href="../extras/resources/course_resources.html">
 <span class="dropdown-text">üìö Reference Materials</span></a>
  </li>  
        <li class="dropdown-header">üéØ Practical Examples</li>
        <li>
    <a class="dropdown-item" href="../extras/examples/normalization_comparison.html">
 <span class="dropdown-text">Normalization Comparison</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/examples/resnet.html">
 <span class="dropdown-text">ResNet Implementation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/examples/text_encoder.html">
 <span class="dropdown-text">Text Encoder</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/examples/tiling-and-patches.html">
 <span class="dropdown-text">Tiling and Patches</span></a>
  </li>  
        <li class="dropdown-header">üìÅ Project Templates</li>
        <li>
    <a class="dropdown-item" href="../extras/projects/project-proposal-template.html">
 <span class="dropdown-text">Project Proposal Template</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../extras/projects/mvp-template.html">
 <span class="dropdown-text">MVP Presentation Template</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kcaylor/GEOG-288KC-geospatial-foundation-models" target="_blank"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">Week 0: Getting Started</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
            <p class="subtitle lead">Setting up for geospatial AI in the UCSB AI Sandbox + Project Applications</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-0-overview" id="toc-week-0-overview" class="nav-link active" data-scroll-target="#week-0-overview">Week 0 Overview</a>
  <ul class="collapse">
  <li><a href="#key-activities" id="toc-key-activities" class="nav-link" data-scroll-target="#key-activities">Key Activities</a></li>
  </ul></li>
  <li><a href="#basics-of-foundation-models-and-llmgfm-comparisons" id="toc-basics-of-foundation-models-and-llmgfm-comparisons" class="nav-link" data-scroll-target="#basics-of-foundation-models-and-llmgfm-comparisons">Basics of Foundation Models and LLM/GFM Comparisons</a></li>
  <li><a href="#gfm-architecture-cheatsheet" id="toc-gfm-architecture-cheatsheet" class="nav-link" data-scroll-target="#gfm-architecture-cheatsheet">GFM Architecture Cheatsheet</a>
  <ul class="collapse">
  <li><a href="#roadmap-at-a-glance" id="toc-roadmap-at-a-glance" class="nav-link" data-scroll-target="#roadmap-at-a-glance">Roadmap at a glance</a></li>
  <li><a href="#minimal-structure-youll-use" id="toc-minimal-structure-youll-use" class="nav-link" data-scroll-target="#minimal-structure-youll-use">Minimal structure you‚Äôll use</a></li>
  <li><a href="#what-each-part-does-one-liners" id="toc-what-each-part-does-one-liners" class="nav-link" data-scroll-target="#what-each-part-does-one-liners">What each part does (one-liners)</a></li>
  <li><a href="#from-scratch-vs-library-backed" id="toc-from-scratch-vs-library-backed" class="nav-link" data-scroll-target="#from-scratch-vs-library-backed">From-scratch vs library-backed</a></li>
  <li><a href="#quick-start-conceptual" id="toc-quick-start-conceptual" class="nav-link" data-scroll-target="#quick-start-conceptual">Quick start (conceptual)</a></li>
  <li><a href="#mvp-vs-later-phases" id="toc-mvp-vs-later-phases" class="nav-link" data-scroll-target="#mvp-vs-later-phases">MVP vs later phases</a></li>
  <li><a href="#comprehensive-course-roadmap-stages-files-libraries" id="toc-comprehensive-course-roadmap-stages-files-libraries" class="nav-link" data-scroll-target="#comprehensive-course-roadmap-stages-files-libraries">Comprehensive course roadmap (stages, files, libraries)</a></li>
  <li><a href="#next-week-preview" id="toc-next-week-preview" class="nav-link" data-scroll-target="#next-week-preview">Next Week Preview</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="week-0-overview" class="level2">
<h2 class="anchored" data-anchor-id="week-0-overview">Week 0 Overview</h2>
<p>Welcome to GEOG 288KC: Geospatial Foundation Models and Applications! This week focuses on defining our course goals, the architecture of the class and the code we will be working with, and getting everyone set up with a consistent computational environment.</p>
<section id="key-activities" class="level3">
<h3 class="anchored" data-anchor-id="key-activities">Key Activities</h3>
<ul class="task-list">
<li><label><input type="checkbox">Complete local/server environment setup</label></li>
<li><label><input type="checkbox">Set up development environment (Python, PyTorch, Earth Engine access)</label></li>
<li><label><input type="checkbox">Submit project application describing experience and research interests</label></li>
</ul>
</section>
</section>
<section id="basics-of-foundation-models-and-llmgfm-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="basics-of-foundation-models-and-llmgfm-comparisons">Basics of Foundation Models and LLM/GFM Comparisons</h2>
</section>
<section id="gfm-architecture-cheatsheet" class="level2">
<h2 class="anchored" data-anchor-id="gfm-architecture-cheatsheet">GFM Architecture Cheatsheet</h2>
<p>This is a quick-reference for how our Geospatial Foundation Model (GFM) is organized, what each part does, and where to look during the course. We implement simple, readable components first, then show how to swap in optimized library counterparts as needed.</p>
<section id="roadmap-at-a-glance" class="level3">
<h3 class="anchored" data-anchor-id="roadmap-at-a-glance">Roadmap at a glance</h3>
<div class="no-row-height"></div>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph TD
  A[Week 1: Data Foundations] --&gt; B[Week 2: Attention &amp; Blocks]
  B --&gt; C[Week 3: Full Encoder]
  C --&gt; D[Week 4: MAE Pretraining]
  D --&gt; E[Week 5: Training Loop]
  E --&gt; F[Week 6: Eval &amp; Viz]
  F --&gt; G[Week 7+: Interop &amp; Scale]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="minimal-structure-youll-use" class="level3">
<h3 class="anchored" data-anchor-id="minimal-structure-youll-use">Minimal structure you‚Äôll use</h3>
<pre class="text"><code>geogfm/
  core/
    config.py                # Minimal typed configs for model, data, training
  data/
    loaders.py               # build_dataloader(...)
    datasets/
      stac_dataset.py        # Simple STAC-backed dataset
    transforms/
      normalization.py       # Per-channel normalization
      patchify.py            # Extract fixed-size patches
  modules/
    attention/
      multihead_attention.py     # Standard MHA (from scratch)
    embeddings/
      patch_embedding.py         # Conv patch embedding
      positional_encoding.py     # Simple positional encoding
    blocks/
      transformer_block.py       # PreNorm block (MHA + MLP)
    heads/
      reconstruction_head.py     # Lightweight decoder/readout
    losses/
      mae_loss.py                # Masked reconstruction loss
  models/
    gfm_vit.py                   # GeoViT-style encoder
    gfm_mae.py                   # MAE wrapper (masking + encoder + head)
  training/
    optimizer.py                 # AdamW builder
    loop.py                      # fit/train_step/eval_step with basic checkpointing
  evaluation/
    visualization.py             # Visualize inputs vs reconstructions

# Outside the package (repo root)
configs/   # Small YAML/JSON run configs
tests/     # Unit tests
data/      # Datasets, splits, stats, build scripts</code></pre>
</section>
<section id="what-each-part-does-one-liners" class="level3">
<h3 class="anchored" data-anchor-id="what-each-part-does-one-liners">What each part does (one-liners)</h3>
<ul>
<li>core/config.py: Typed configs for model/data/training; keeps parameters organized.</li>
<li>data/datasets/stac_dataset.py: Reads imagery + metadata (e.g., STAC), returns tensors.</li>
<li>data/transforms/normalization.py: Normalizes channels using precomputed stats.</li>
<li>data/transforms/patchify.py: Turns large images into uniform patches for ViT.</li>
<li>data/loaders.py: Builds PyTorch DataLoaders for train/val.</li>
<li>modules/embeddings/patch_embedding.py: Projects image patches into token vectors.</li>
<li>modules/embeddings/positional_encoding.py: Adds position info to tokens.</li>
<li>modules/attention/multihead_attention.py: Lets tokens attend to each other.</li>
<li>modules/blocks/transformer_block.py: Core transformer layer (attention + MLP).</li>
<li>modules/heads/reconstruction_head.py: Reconstructs pixels from encoded tokens.</li>
<li>modules/losses/mae_loss.py: Computes masked reconstruction loss for MAE.</li>
<li>models/gfm_vit.py: Assembles the encoder backbone from blocks.</li>
<li>models/gfm_mae.py: Wraps encoder with masking + reconstruction for pretraining.</li>
<li>training/optimizer.py: Creates AdamW with common defaults.</li>
<li>training/loop.py: Runs epochs, backprop, validation, and simple checkpoints.</li>
<li>evaluation/visualization.py: Plots sample inputs and reconstructions.</li>
</ul>
</section>
<section id="from-scratch-vs-library-backed" class="level3">
<h3 class="anchored" data-anchor-id="from-scratch-vs-library-backed">From-scratch vs library-backed</h3>
<ul>
<li>Use PyTorch for Dataset/DataLoader, AdamW, schedulers, AMP, and checkpointing.</li>
<li>Build core blocks from scratch first: PatchEmbedding, MHA, TransformerBlock, MAE loss/head.</li>
<li>Later, swap in optimized options: <code>torch.nn.MultiheadAttention</code>, timm ViT blocks, FlashAttention, TorchGeo datasets, torchmetrics.</li>
</ul>
</section>
<section id="quick-start-conceptual" class="level3">
<h3 class="anchored" data-anchor-id="quick-start-conceptual">Quick start (conceptual)</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.core.config <span class="im">import</span> ModelConfig, DataConfig, TrainConfig</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.models.gfm_vit <span class="im">import</span> GeoViTBackbone</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.models.gfm_mae <span class="im">import</span> MaskedAutoencoder</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.data.loaders <span class="im">import</span> build_dataloader</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.training.loop <span class="im">import</span> fit</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>model_cfg <span class="op">=</span> ModelConfig(architecture<span class="op">=</span><span class="st">"gfm_vit"</span>, embed_dim<span class="op">=</span><span class="dv">768</span>, depth<span class="op">=</span><span class="dv">12</span>, image_size<span class="op">=</span><span class="dv">224</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data_cfg <span class="op">=</span> DataConfig(dataset<span class="op">=</span><span class="st">"stac"</span>, patch_size<span class="op">=</span><span class="dv">16</span>, num_workers<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>train_cfg <span class="op">=</span> TrainConfig(epochs<span class="op">=</span><span class="dv">1</span>, batch_size<span class="op">=</span><span class="dv">8</span>, optimizer<span class="op">=</span>{<span class="st">"name"</span>: <span class="st">"adamw"</span>, <span class="st">"lr"</span>: <span class="fl">2e-4</span>})</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> GeoViTBackbone(model_cfg)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> MaskedAutoencoder(model_cfg, encoder)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>train_dl, val_dl <span class="op">=</span> build_dataloader(data_cfg)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>fit(model, (train_dl, val_dl), train_cfg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>What to notice: - The encoder and MAE wrapper are separate, so we can reuse the encoder for other tasks later. - Data transforms (normalize/patchify) are decoupled from the model and driven by config.</p>
</section>
<section id="mvp-vs-later-phases" class="level3">
<h3 class="anchored" data-anchor-id="mvp-vs-later-phases">MVP vs later phases</h3>
<ul>
<li>MVP (Weeks 1‚Äì6): files shown above; single-node training; basic logging and visualization.</li>
<li>Later (Weeks 7‚Äì10): interop with existing models (e.g., Prithvi), task heads (classification/segmentation), inference tiling, Hub integration.</li>
</ul>
</section>
<section id="comprehensive-course-roadmap-stages-files-libraries" class="level3">
<h3 class="anchored" data-anchor-id="comprehensive-course-roadmap-stages-files-libraries">Comprehensive course roadmap (stages, files, libraries)</h3>
<p>This table maps each week to the broader stages (see the course index), the key <code>geogfm</code> files you‚Äôll touch, and the primary deep learning tools you‚Äôll rely on.</p>
<div class="table-responsive">
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 37%">
<col style="width: 21%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>Week</th>
<th>Stage</th>
<th>Focus</th>
<th>You will build (geogfm)</th>
<th>Library tools</th>
<th>Outcome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>Stage 1: Build GFM Architecture</td>
<td>Data Foundations</td>
<td><code>core/config.py</code>; <code>data/datasets/stac_dataset.py</code>; <code>data/transforms/{normalization.py, patchify.py}</code>; <code>data/loaders.py</code></td>
<td><code>torch.utils.data.Dataset</code>/<code>DataLoader</code>, <code>rasterio</code>, <code>numpy</code></td>
<td>Config-driven dataloaders that yield normalized patches</td>
</tr>
<tr class="even">
<td>2</td>
<td>Stage 1</td>
<td>Attention &amp; Blocks</td>
<td><code>modules/embeddings/{patch_embedding.py, positional_encoding.py}</code>; <code>modules/attention/multihead_attention.py</code>; <code>modules/blocks/transformer_block.py</code></td>
<td><code>torch.nn</code> (compare with <code>torch.nn.MultiheadAttention</code>)</td>
<td>Blocks run forward with stable shapes; unit tests green</td>
</tr>
<tr class="odd">
<td>3</td>
<td>Stage 1</td>
<td>Complete Architecture</td>
<td><code>models/gfm_vit.py</code>; <code>modules/heads/reconstruction_head.py</code></td>
<td><code>torch.nn</code> (timm as reference)</td>
<td>Encoder assembled; end-to-end forward on dummy input</td>
</tr>
<tr class="even">
<td>4</td>
<td>Stage 2: Train Foundation Model</td>
<td>MAE Pretraining</td>
<td><code>models/gfm_mae.py</code>; <code>modules/losses/mae_loss.py</code></td>
<td><code>torch</code> masking utilities, <code>numpy</code></td>
<td>Masking + reconstruction; loss decreases on toy batch</td>
</tr>
<tr class="odd">
<td>5</td>
<td>Stage 2</td>
<td>Training Optimization</td>
<td><code>training/optimizer.py</code>; <code>training/loop.py</code></td>
<td><code>torch.optim.AdamW</code>; schedulers, AMP optional</td>
<td>Single-epoch run; basic checkpoint save/restore</td>
</tr>
<tr class="even">
<td>6</td>
<td>Stage 2</td>
<td>Evaluation &amp; Analysis</td>
<td><code>evaluation/visualization.py</code>; (optional) <code>evaluation/metrics.py</code></td>
<td><code>matplotlib</code>; <code>torchmetrics</code> optional</td>
<td>Recon visuals; track validation loss/PSNR</td>
</tr>
<tr class="odd">
<td>7</td>
<td>Stage 2</td>
<td>Integration w/ Pretrained</td>
<td>(light) <code>core/registry.py</code>; <code>interoperability/huggingface.py</code> stubs</td>
<td><code>huggingface_hub</code>, <code>transformers</code> optional</td>
<td>Show mapping to Prithvi structure; plan switch</td>
</tr>
<tr class="even">
<td>8</td>
<td>Stage 3: Apply &amp; Deploy</td>
<td>Task Fine-tuning</td>
<td><code>tasks/{classification.py|segmentation.py}</code> (light heads)</td>
<td><code>torch.nn.CrossEntropyLoss</code>; timm optional</td>
<td>Head swap on frozen encoder; small dataset demo</td>
</tr>
<tr class="odd">
<td>9</td>
<td>Stage 3</td>
<td>Deployment &amp; Inference</td>
<td><code>inference/{tiling.py, sliding_window.py}</code></td>
<td><code>numpy</code>, <code>rasterio</code> windows</td>
<td>Sliding-window inference on a small scene</td>
</tr>
<tr class="even">
<td>10</td>
<td>Stage 3</td>
<td>Presentations &amp; Synthesis</td>
<td>Project deliverables (no new <code>geogfm</code> code required)</td>
<td>‚Äî</td>
<td>Present MVP builds, analysis, transition plan</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="next-week-preview" class="level3">
<h3 class="anchored" data-anchor-id="next-week-preview">Next Week Preview</h3>
<p>Week 1 will start building our model, beginning with fundamental data loaders and transformers needed to use geospatial data in deep learning.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kellycaylor\.github\.io\/geoAI");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb3" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Week 0: Getting Started"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Setting up for geospatial AI in the UCSB AI Sandbox + Project Applications"</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Week 0 Overview</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>Welcome to GEOG 288KC: Geospatial Foundation Models and Applications! This week focuses on defining our course goals, the architecture of the class and the code we will be working with, and getting everyone set up with a consistent computational environment.</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Activities</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Complete local/server environment setup</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Set up development environment (Python, PyTorch, Earth Engine access)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Submit project application describing experience and research interests</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basics of Foundation Models and LLM/GFM Comparisons</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## GFM Architecture Cheatsheet</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>This is a quick-reference for how our Geospatial Foundation Model (GFM) is organized, what each part does, and where to look during the course. We implement simple, readable components first, then show how to swap in optimized library counterparts as needed.</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">### Roadmap at a glance</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;div class="no-row-height"&gt;&lt;/div&gt;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="in">graph TD</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="in">  A[Week 1: Data Foundations] --&gt; B[Week 2: Attention &amp; Blocks]</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="in">  B --&gt; C[Week 3: Full Encoder]</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="in">  C --&gt; D[Week 4: MAE Pretraining]</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="in">  D --&gt; E[Week 5: Training Loop]</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="in">  E --&gt; F[Week 6: Eval &amp; Viz]</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="in">  F --&gt; G[Week 7+: Interop &amp; Scale]</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="fu">### Minimal structure you‚Äôll use</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="in">```text</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="in">geogfm/</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="in">  core/</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="in">    config.py                # Minimal typed configs for model, data, training</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="in">  data/</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a><span class="in">    loaders.py               # build_dataloader(...)</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="in">    datasets/</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="in">      stac_dataset.py        # Simple STAC-backed dataset</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a><span class="in">    transforms/</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="in">      normalization.py       # Per-channel normalization</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a><span class="in">      patchify.py            # Extract fixed-size patches</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="in">  modules/</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="in">    attention/</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="in">      multihead_attention.py     # Standard MHA (from scratch)</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="in">    embeddings/</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="in">      patch_embedding.py         # Conv patch embedding</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a><span class="in">      positional_encoding.py     # Simple positional encoding</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="in">    blocks/</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="in">      transformer_block.py       # PreNorm block (MHA + MLP)</span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="in">    heads/</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a><span class="in">      reconstruction_head.py     # Lightweight decoder/readout</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="in">    losses/</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="in">      mae_loss.py                # Masked reconstruction loss</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a><span class="in">  models/</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="in">    gfm_vit.py                   # GeoViT-style encoder</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="in">    gfm_mae.py                   # MAE wrapper (masking + encoder + head)</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a><span class="in">  training/</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a><span class="in">    optimizer.py                 # AdamW builder</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="in">    loop.py                      # fit/train_step/eval_step with basic checkpointing</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="in">  evaluation/</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a><span class="in">    visualization.py             # Visualize inputs vs reconstructions</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="in"># Outside the package (repo root)</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="in">configs/   # Small YAML/JSON run configs</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a><span class="in">tests/     # Unit tests</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="in">data/      # Datasets, splits, stats, build scripts</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### What each part does (one-liners)</span></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>core/config.py: Typed configs for model/data/training; keeps parameters organized.</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>data/datasets/stac_dataset.py: Reads imagery + metadata (e.g., STAC), returns tensors.</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>data/transforms/normalization.py: Normalizes channels using precomputed stats.</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>data/transforms/patchify.py: Turns large images into uniform patches for ViT.</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>data/loaders.py: Builds PyTorch DataLoaders for train/val.</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/embeddings/patch_embedding.py: Projects image patches into token vectors.</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/embeddings/positional_encoding.py: Adds position info to tokens.</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/attention/multihead_attention.py: Lets tokens attend to each other.</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/blocks/transformer_block.py: Core transformer layer (attention + MLP).</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/heads/reconstruction_head.py: Reconstructs pixels from encoded tokens.</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>modules/losses/mae_loss.py: Computes masked reconstruction loss for MAE.</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>models/gfm_vit.py: Assembles the encoder backbone from blocks.</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>models/gfm_mae.py: Wraps encoder with masking + reconstruction for pretraining.</span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>training/optimizer.py: Creates AdamW with common defaults.</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>training/loop.py: Runs epochs, backprop, validation, and simple checkpoints.</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>evaluation/visualization.py: Plots sample inputs and reconstructions.</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### From-scratch vs library-backed</span></span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use PyTorch for Dataset/DataLoader, AdamW, schedulers, AMP, and checkpointing.</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Build core blocks from scratch first: PatchEmbedding, MHA, TransformerBlock, MAE loss/head.</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Later, swap in optimized options: <span class="in">`torch.nn.MultiheadAttention`</span>, timm ViT blocks, FlashAttention, TorchGeo datasets, torchmetrics.</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a><span class="fu">### Quick start (conceptual)</span></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.core.config <span class="im">import</span> ModelConfig, DataConfig, TrainConfig</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.models.gfm_vit <span class="im">import</span> GeoViTBackbone</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.models.gfm_mae <span class="im">import</span> MaskedAutoencoder</span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.data.loaders <span class="im">import</span> build_dataloader</span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> geogfm.training.loop <span class="im">import</span> fit</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>model_cfg <span class="op">=</span> ModelConfig(architecture<span class="op">=</span><span class="st">"gfm_vit"</span>, embed_dim<span class="op">=</span><span class="dv">768</span>, depth<span class="op">=</span><span class="dv">12</span>, image_size<span class="op">=</span><span class="dv">224</span>)</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>data_cfg <span class="op">=</span> DataConfig(dataset<span class="op">=</span><span class="st">"stac"</span>, patch_size<span class="op">=</span><span class="dv">16</span>, num_workers<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>train_cfg <span class="op">=</span> TrainConfig(epochs<span class="op">=</span><span class="dv">1</span>, batch_size<span class="op">=</span><span class="dv">8</span>, optimizer<span class="op">=</span>{<span class="st">"name"</span>: <span class="st">"adamw"</span>, <span class="st">"lr"</span>: <span class="fl">2e-4</span>})</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>encoder <span class="op">=</span> GeoViTBackbone(model_cfg)</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> MaskedAutoencoder(model_cfg, encoder)</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>train_dl, val_dl <span class="op">=</span> build_dataloader(data_cfg)</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>fit(model, (train_dl, val_dl), train_cfg)</span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>What to notice:</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The encoder and MAE wrapper are separate, so we can reuse the encoder for other tasks later.</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data transforms (normalize/patchify) are decoupled from the model and driven by config.</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a><span class="fu">### MVP vs later phases</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>MVP (Weeks 1‚Äì6): files shown above; single-node training; basic logging and visualization.</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Later (Weeks 7‚Äì10): interop with existing models (e.g., Prithvi), task heads (classification/segmentation), inference tiling, Hub integration.</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comprehensive course roadmap (stages, files, libraries)</span></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>This table maps each week to the broader stages (see the course index), the key <span class="in">`geogfm`</span> files you‚Äôll touch, and the primary deep learning tools you‚Äôll rely on.</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>::: {.table-responsive}</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>| Week | Stage | Focus | You will build (geogfm) | Library tools | Outcome |</span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>|------|-------|-------|--------------------------|---------------|---------|</span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>| 1 | Stage 1: Build GFM Architecture | Data Foundations | <span class="in">`core/config.py`</span>; <span class="in">`data/datasets/stac_dataset.py`</span>; <span class="in">`data/transforms/{normalization.py, patchify.py}`</span>; <span class="in">`data/loaders.py`</span> | <span class="in">`torch.utils.data.Dataset`</span>/<span class="in">`DataLoader`</span>, <span class="in">`rasterio`</span>, <span class="in">`numpy`</span> | Config-driven dataloaders that yield normalized patches |</span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>| 2 | Stage 1 | Attention &amp; Blocks | <span class="in">`modules/embeddings/{patch_embedding.py, positional_encoding.py}`</span>; <span class="in">`modules/attention/multihead_attention.py`</span>; <span class="in">`modules/blocks/transformer_block.py`</span> | <span class="in">`torch.nn`</span> (compare with <span class="in">`torch.nn.MultiheadAttention`</span>) | Blocks run forward with stable shapes; unit tests green |</span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>| 3 | Stage 1 | Complete Architecture | <span class="in">`models/gfm_vit.py`</span>; <span class="in">`modules/heads/reconstruction_head.py`</span> | <span class="in">`torch.nn`</span> (timm as reference) | Encoder assembled; end-to-end forward on dummy input |</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>| 4 | Stage 2: Train Foundation Model | MAE Pretraining | <span class="in">`models/gfm_mae.py`</span>; <span class="in">`modules/losses/mae_loss.py`</span> | <span class="in">`torch`</span> masking utilities, <span class="in">`numpy`</span> | Masking + reconstruction; loss decreases on toy batch |</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>| 5 | Stage 2 | Training Optimization | <span class="in">`training/optimizer.py`</span>; <span class="in">`training/loop.py`</span> | <span class="in">`torch.optim.AdamW`</span>; schedulers, AMP optional | Single-epoch run; basic checkpoint save/restore |</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>| 6 | Stage 2 | Evaluation &amp; Analysis | <span class="in">`evaluation/visualization.py`</span>; (optional) <span class="in">`evaluation/metrics.py`</span> | <span class="in">`matplotlib`</span>; <span class="in">`torchmetrics`</span> optional | Recon visuals; track validation loss/PSNR |</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>| 7 | Stage 2 | Integration w/ Pretrained | (light) <span class="in">`core/registry.py`</span>; <span class="in">`interoperability/huggingface.py`</span> stubs | <span class="in">`huggingface_hub`</span>, <span class="in">`transformers`</span> optional | Show mapping to Prithvi structure; plan switch |</span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>| 8 | Stage 3: Apply &amp; Deploy | Task Fine-tuning | <span class="in">`tasks/{classification.py|segmentation.py}`</span> (light heads) | <span class="in">`torch.nn.CrossEntropyLoss`</span>; timm optional | Head swap on frozen encoder; small dataset demo |</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>| 9 | Stage 3 | Deployment &amp; Inference | <span class="in">`inference/{tiling.py, sliding_window.py}`</span> | <span class="in">`numpy`</span>, <span class="in">`rasterio`</span> windows | Sliding-window inference on a small scene |</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>| 10 | Stage 3 | Presentations &amp; Synthesis | Project deliverables (no new <span class="in">`geogfm`</span> code required) | ‚Äî | Present MVP builds, analysis, transition plan |</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Next Week Preview</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>Week 1 will start building our model, beginning with fundamental data loaders and transformers needed to use geospatial data in deep learning.</span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/geog-logo.png" class="img-fluid figure-img" width="250"></p>
<figcaption>Department of Geography logo</figcaption>
</figure>
</div>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This website is built with <a href="https://github.com/environmental-data-science/geog-288kc-geospatial-foundation-models"><i class="fa-brands fa-github" title="the github octocat logo" aria-label="github"></i></a> and <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>